<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎯 WCAG 2.2 Final Validation - Integra Senior Care</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .header {
            text-align: center;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .test-container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .status-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            min-width: 200px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 8px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .btn:focus {
            outline: 3px solid #ffcc00;
            outline-offset: 2px;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
        }
        
        /* WCAG Text Spacing Test Styles */
        .wcag-text-spacing {
            line-height: 2.0 !important;
            letter-spacing: 0.15em !important;
            word-spacing: 0.2em !important;
            border: 4px solid #00ff00 !important;
            background: linear-gradient(135deg, #f0fff0 0%, #e8f5e8 100%) !important;
            padding: 20px !important;
            border-radius: 8px !important;
            transition: all 0.3s ease !important;
        }
        
        .wcag-text-spacing * {
            line-height: 2.0 !important;
            letter-spacing: 0.15em !important;
            word-spacing: 0.2em !important;
        }
        
        .wcag-text-spacing p {
            margin-bottom: 2.5em !important;
        }
        
        /* Enhanced Focus Indicators */
        button:focus,
        input:focus,
        select:focus,
        a:focus,
        [tabindex]:focus {
            outline: 3px solid #ffcc00 !important;
            outline-offset: 2px !important;
            box-shadow: 0 0 0 5px rgba(255, 204, 0, 0.3) !important;
        }
        
        /* Hover/Focus Content */
        .hover-test {
            position: relative;
            display: inline-block;
            cursor: pointer;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 15px 20px;
            margin: 10px;
            border-radius: 8px;
            border: 2px solid #2196f3;
            transition: all 0.3s ease;
        }
        
        .hover-test:hover,
        .hover-test:focus {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
        }
        
        .hover-content {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 12px 16px;
            border-radius: 6px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .hover-content::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #333;
        }
        
        .hover-test:hover .hover-content,
        .hover-test:focus .hover-content {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(5px);
        }
        
        .results-container {
            background: #f8f9fa;
            border-left: 4px solid #007cba;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .status-active {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }
        
        .status-inactive {
            background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
            color: white;
        }
        
        .emoji {
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="status-panel" id="statusPanel">
        <div id="status" class="status-inactive">
            <strong>🔴 WCAG Tests Inactive</strong>
        </div>
        <div id="quickStats" style="margin-top: 10px; font-size: 12px;">
            Ready for testing...
        </div>
    </div>

    <div class="header">
        <h1>🎯 WCAG 2.2 Final Validation</h1>
        <h2>Integra Senior Care - Accessibility Implementation</h2>
        <p><strong>Status:</strong> All 4 WCAG 2.2 criteria implemented and ready for validation</p>
    </div>

    <!-- Control Panel -->
    <div class="test-container">
        <h2>🎮 Control Panel</h2>
        <div style="text-align: center;">
            <button class="btn" id="toggleTextSpacing" onclick="toggleTextSpacing()">
                <span class="emoji">🔤</span> Toggle Text Spacing Test
            </button>
            <button class="btn" onclick="runDiagnostic()">
                <span class="emoji">🔍</span> Run Diagnostic
            </button>
            <button class="btn btn-success" onclick="runAllValidationTests()">
                <span class="emoji">🧪</span> Run All Validation Tests
            </button>
            <button class="btn btn-warning" onclick="clearStatus()">
                <span class="emoji">🧹</span> Clear Status
            </button>
        </div>
    </div>

    <!-- Text Spacing Test Content -->
    <div class="test-container" id="textContent">
        <h2>📝 1.4.12 Text Spacing Test Content</h2>
        <p>Este es un párrafo de prueba para validar el espaciado de texto según WCAG 2.2. El texto debe mantener su legibilidad con el espaciado aumentado de líneas, letras, palabras y párrafos sin pérdida de contenido o funcionalidad.</p>
        
        <p>Múltiples párrafos ayudan a probar los requisitos de espaciado entre párrafos. Cada párrafo debe tener un espaciado adecuado entre ellos para cumplir con el criterio 1.4.12.</p>
        
        <h3>Lista de Verificación:</h3>
        <ul>
            <li>✅ Line height: mínimo 1.5× el tamaño de fuente</li>
            <li>✅ Letter spacing: mínimo 0.12× el tamaño de fuente</li>
            <li>✅ Word spacing: mínimo 0.16× el tamaño de fuente</li>
            <li>✅ Paragraph spacing: mínimo 2× el tamaño de fuente</li>
        </ul>
        
        <blockquote style="border-left: 4px solid #007cba; padding-left: 20px; margin: 20px 0; font-style: italic;">
            "El criterio 1.4.12 asegura que los usuarios puedan personalizar el espaciado del texto sin perder contenido o funcionalidad."
        </blockquote>
    </div>

    <!-- Focus Test -->
    <div class="test-container">
        <h2>🎯 2.4.11 Focus Not Obscured & 2.4.7 Focus Visible Test</h2>
        <p>Use la tecla <kbd>Tab</kbd> para navegar entre estos elementos y observar los indicadores de focus mejorados:</p>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
            <button class="btn" tabindex="1">🎯 Botón de Enfoque 1</button>
            <button class="btn btn-success" tabindex="2">🎯 Botón de Enfoque 2</button>
            <input type="text" placeholder="Campo de entrada de prueba" tabindex="3" style="padding: 12px; border-radius: 6px; border: 2px solid #ddd;">
            <select tabindex="4" style="padding: 12px; border-radius: 6px; border: 2px solid #ddd;">
                <option>📋 Opción 1</option>
                <option>📋 Opción 2</option>
                <option>📋 Opción 3</option>
            </select>
            <a href="#" tabindex="5" style="padding: 12px; background: #e3f2fd; border-radius: 6px; text-decoration: none; display: block; text-align: center;">🔗 Enlace de prueba</a>
        </div>
    </div>

    <!-- Hover/Focus Content Test -->
    <div class="test-container">
        <h2>🖱️ 1.4.13 Content on Hover/Focus Test</h2>
        <p>Haga hover o focus sobre estos elementos para probar el contenido adicional. Presione <kbd>Escape</kbd> para ocultar:</p>
        
        <div style="text-align: center; margin: 30px 0;">
            <div class="hover-test" tabindex="6">
                <span class="emoji">🖱️</span> Hover/Focus sobre mí
                <div class="hover-content">
                    ✅ Este contenido aparece en hover/focus y cumple con WCAG 1.4.13
                </div>
            </div>
            
            <div class="hover-test" tabindex="7">
                <span class="emoji">💬</span> Tooltip de ejemplo
                <div class="hover-content">
                    📋 Contenido del tooltip - Dismissible, Hoverable, Persistent
                </div>
            </div>
            
            <div class="hover-test" tabindex="8">
                <span class="emoji">ℹ️</span> Información adicional
                <div class="hover-content">
                    🎯 Cumple con los 3 requisitos: Dismissible, Hoverable, Persistent
                </div>
            </div>
        </div>
    </div>

    <!-- Results Container -->
    <div class="test-container">
        <h2>📊 Resultados del Diagnóstico</h2>
        <div id="diagnosticResults" class="results-container">
            <p>🚀 Haga clic en <strong>"Run Diagnostic"</strong> o <strong>"Run All Validation Tests"</strong> para ver los resultados del análisis WCAG 2.2.</p>
        </div>
    </div>

    <!-- WCAG Compliance Summary -->
    <div class="test-container">
        <h2>🏆 WCAG 2.2 Compliance Summary</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
            <div style="background: #e8f5e9; padding: 20px; border-radius: 8px; border-left: 4px solid #4caf50;">
                <h3>✅ 1.4.12 Text Spacing</h3>
                <p>Implementado con soporte completo para espaciado personalizable sin pérdida de contenido.</p>
            </div>
            <div style="background: #e3f2fd; padding: 20px; border-radius: 8px; border-left: 4px solid #2196f3;">
                <h3>✅ 2.4.11 Focus Not Obscured</h3>
                <p>Indicadores de focus nunca completamente ocultos con z-index optimizado.</p>
            </div>
            <div style="background: #fff3e0; padding: 20px; border-radius: 8px; border-left: 4px solid #ff9800;">
                <h3>✅ 1.4.13 Content on Hover/Focus</h3>
                <p>Contenido adicional dismissible, hoverable y persistent según especificación.</p>
            </div>
            <div style="background: #fce4ec; padding: 20px; border-radius: 8px; border-left: 4px solid #e91e63;">
                <h3>✅ 2.4.7 Focus Visible Enhancement</h3>
                <p>Indicadores de focus mejorados con alto contraste y visibilidad superior.</p>
            </div>
        </div>
    </div>

    <script>
        let textSpacingActive = false;

        function updateStatus(message, isActive, stats = '') {
            const status = document.getElementById('status');
            const quickStats = document.getElementById('quickStats');
            
            status.innerHTML = `<strong>${isActive ? '🟢' : '🔴'} ${message}</strong>`;
            status.className = isActive ? 'status-active' : 'status-inactive';
            quickStats.textContent = stats || 'Ready for testing...';
        }

        function toggleTextSpacing() {
            const textContent = document.getElementById('textContent');
            const button = document.getElementById('toggleTextSpacing');
            
            console.log('🔤 Toggle Text Spacing clicked');
            
            if (textSpacingActive) {
                // Remove text spacing
                textContent.classList.remove('wcag-text-spacing');
                button.innerHTML = '<span class="emoji">🔤</span> Toggle Text Spacing Test';
                updateStatus('WCAG Text Spacing: INACTIVE', false);
                textSpacingActive = false;
                console.log('✅ Text spacing REMOVED');
            } else {
                // Apply text spacing
                textContent.classList.add('wcag-text-spacing');
                button.innerHTML = '<span class="emoji">✅</span> Remove Text Spacing Test';
                updateStatus('WCAG Text Spacing: ACTIVE', true, 'Text spacing applied successfully');
                textSpacingActive = true;
                console.log('✅ Text spacing APPLIED');
            }
            
            // Log current styles for debugging
            const computedStyle = window.getComputedStyle(textContent);
            console.log('Current styles:', {
                lineHeight: computedStyle.lineHeight,
                letterSpacing: computedStyle.letterSpacing,
                wordSpacing: computedStyle.wordSpacing,
                border: computedStyle.border,
                background: computedStyle.backgroundColor
            });
        }

        function runDiagnostic() {
            const results = document.getElementById('diagnosticResults');
            let html = '<h3>🔍 Diagnostic Results</h3>';
            
            // Check CSS classes
            const textContent = document.getElementById('textContent');
            const hasTextSpacing = textContent.classList.contains('wcag-text-spacing');
            
            html += `<div style="background: ${hasTextSpacing ? '#e8f5e9' : '#ffebee'}; padding: 15px; border-radius: 6px; margin: 10px 0;">`;
            html += `<p><strong>Text Spacing Class:</strong> ${hasTextSpacing ? '✅ Applied' : '❌ Not Applied'}</p>`;
            html += '</div>';
            
            // Check computed styles
            const computedStyle = window.getComputedStyle(textContent);
            html += '<div style="background: #f5f5f5; padding: 15px; border-radius: 6px; margin: 10px 0;">';
            html += `<p><strong>Line Height:</strong> ${computedStyle.lineHeight}</p>`;
            html += `<p><strong>Letter Spacing:</strong> ${computedStyle.letterSpacing}</p>`;
            html += `<p><strong>Word Spacing:</strong> ${computedStyle.wordSpacing}</p>`;
            html += `<p><strong>Border:</strong> ${computedStyle.border}</p>`;
            html += '</div>';
            
            // Check focusable elements
            const focusableElements = document.querySelectorAll('button, input, select, a, [tabindex]');
            html += '<div style="background: #e3f2fd; padding: 15px; border-radius: 6px; margin: 10px 0;">';
            html += `<p><strong>Focusable Elements:</strong> ${focusableElements.length} found</p>`;
            html += '</div>';
            
            // Check hover elements
            const hoverElements = document.querySelectorAll('.hover-test');
            html += '<div style="background: #fff3e0; padding: 15px; border-radius: 6px; margin: 10px 0;">';
            html += `<p><strong>Hover Test Elements:</strong> ${hoverElements.length} found</p>`;
            html += '</div>';
            
            results.innerHTML = html;
            updateStatus('Diagnostic complete', true, `${focusableElements.length} focusable, ${hoverElements.length} hover elements`);
            console.log('🔍 Diagnostic complete');
        }

        function runAllValidationTests() {
            console.log('🧪 Running all WCAG 2.2 validation tests...');
            updateStatus('Running validation tests...', true, 'Testing in progress...');
            
            // Load and run the validation script
            if (typeof window.wcagValidationTests !== 'undefined') {
                window.wcagValidationTests.runAllTests();
            } else {
                // Load the script if not already loaded
                const script = document.createElement('script');
                script.src = '/wcag-validation-script.js';
                script.onload = function() {
                    if (window.wcagValidationTests) {
                        window.wcagValidationTests.runAllTests();
                    }
                };
                document.head.appendChild(script);
            }
        }

        function clearStatus() {
            updateStatus('Status cleared', false);
            document.getElementById('diagnosticResults').innerHTML = '<p>🚀 Status cleared. Run diagnostic or validation tests again.</p>';
            console.log('🧹 Status cleared');
        }

        // Keyboard event handler for Escape key (WCAG 1.4.13 compliance)
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // Hide all hover content
                const hoverContents = document.querySelectorAll('.hover-content');
                hoverContents.forEach(content => {
                    content.style.opacity = '0';
                    content.style.visibility = 'hidden';
                });
                console.log('⌨️ Escape pressed - hover content hidden (WCAG 1.4.13 compliance)');
                updateStatus('Hover content dismissed via Escape', true, 'WCAG 1.4.13 compliance verified');
            }
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎯 WCAG 2.2 Final Validation Page Loaded');
            updateStatus('Page loaded - All tests ready', false, 'Ready for WCAG 2.2 validation');
            
            // Load validation script automatically
            const script = document.createElement('script');
            script.src = '/wcag-validation-script.js';
            document.head.appendChild(script);
        });
    </script>
</body>
</html>
