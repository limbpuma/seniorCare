/*
 * WCAG 2.2 - Criterion 2.4.7: Focus Visible (AA) - Enhancement
 * 
 * Enhanced focus indicators that exceed minimum requirements.
 * Provides stronger, more visible focus indicators for better usability.
 * 
 * Requirements:
 * - Visible focus indicators for all interactive elements
 * - High contrast compatibility  
 * - Multiple visual cues (outline, background, shadow)
 * - Responsive to user preferences
 */

/* ==========================================================================
   WCAG 2.4.7 - Enhanced Focus Visible Implementation
   ========================================================================== */

/* Enhanced focus indicators for all interactive elements */
:focus-visible {
  /* Strong outline with high contrast */
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  
  /* Additional visual cues */
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.2),
    0 2px 8px rgba(0, 102, 204, 0.3) !important;
  
  /* Subtle background change */
  background-color: rgba(0, 102, 204, 0.05) !important;
  
  /* Smooth transition */
  transition: all 0.2s ease-in-out !important;
}

/* Specific enhancements for different element types */

/* Buttons - enhanced with background change */
button:focus-visible,
.btn:focus-visible,
[role="button"]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.25),
    0 3px 10px rgba(0, 102, 204, 0.4) !important;
  transform: translateY(-1px) !important;
}

/* Primary buttons - contrasting focus */
.btn-primary:focus-visible,
button.bg-deep-blue:focus-visible,
button.bg-primary:focus-visible {
  outline: 3px solid #ffffff !important;
  box-shadow: 
    0 0 0 3px #0066cc,
    0 0 0 6px rgba(255, 255, 255, 0.8),
    0 3px 12px rgba(0, 0, 0, 0.3) !important;
}

/* Links - enhanced with underline */
a:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  text-decoration: underline !important;
  text-decoration-color: #0066cc !important;
  text-decoration-thickness: 2px !important;
  background-color: rgba(0, 102, 204, 0.08) !important;
  border-radius: 3px !important;
  box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.2) !important;
}

/* Form inputs - enhanced with border and glow */
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 1px !important;
  border: 2px solid #0066cc !important;
  box-shadow: 
    inset 0 1px 3px rgba(0, 102, 204, 0.1),
    0 0 0 3px rgba(0, 102, 204, 0.2),
    0 2px 6px rgba(0, 102, 204, 0.15) !important;
  background-color: rgba(0, 102, 204, 0.03) !important;
}

/* Checkboxes and radio buttons */
input[type="checkbox"]:focus-visible,
input[type="radio"]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 3px !important;
  box-shadow: 0 0 0 5px rgba(0, 102, 204, 0.3) !important;
}

/* Navigation elements */
nav a:focus-visible,
.nav-link:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  background-color: rgba(0, 102, 204, 0.1) !important;
  border-radius: 4px !important;
  box-shadow: 
    0 0 0 3px rgba(0, 102, 204, 0.2),
    inset 0 0 0 1px rgba(0, 102, 204, 0.1) !important;
}

/* Mobile menu button */
.mobile-menu-button:focus-visible,
[aria-controls]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.3),
    0 2px 8px rgba(0, 102, 204, 0.2) !important;
  background-color: rgba(0, 102, 204, 0.08) !important;
}

/* Card and interactive containers */
.card:focus-visible,
[tabindex]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.15),
    0 4px 12px rgba(0, 102, 204, 0.2) !important;
  transform: translateY(-2px) !important;
}

/* Skip links - extra prominent */
.skip-link:focus-visible,
a[href^="#"]:focus-visible {
  outline: 4px solid #0066cc !important;
  outline-offset: 3px !important;
  background-color: #0066cc !important;
  color: #ffffff !important;
  box-shadow: 
    0 0 0 6px rgba(0, 102, 204, 0.4),
    0 4px 16px rgba(0, 102, 204, 0.5) !important;
  padding: 8px 16px !important;
  border-radius: 6px !important;
  font-weight: bold !important;
  z-index: 10000 !important;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  :focus-visible {
    outline: 4px solid #000000 !important;
    outline-offset: 2px !important;
    background-color: #ffff00 !important;
    color: #000000 !important;
    box-shadow: 
      0 0 0 6px #ffff00,
      0 0 0 8px #000000 !important;
  }
  
  button:focus-visible,
  .btn:focus-visible {
    background-color: #ffff00 !important;
    color: #000000 !important;
    border: 2px solid #000000 !important;
  }
  
  a:focus-visible {
    background-color: #ffff00 !important;
    color: #000000 !important;
    text-decoration-color: #000000 !important;
  }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  :focus-visible {
    outline: 3px solid #66b3ff !important;
    box-shadow: 
      0 0 0 5px rgba(102, 179, 255, 0.3),
      0 2px 8px rgba(102, 179, 255, 0.4) !important;
    background-color: rgba(102, 179, 255, 0.08) !important;
  }
  
  .btn-primary:focus-visible,
  button.bg-deep-blue:focus-visible {
    outline: 3px solid #66b3ff !important;
    box-shadow: 
      0 0 0 3px #66b3ff,
      0 0 0 6px rgba(102, 179, 255, 0.5),
      0 3px 12px rgba(102, 179, 255, 0.3) !important;
  }
}

/* Windows High Contrast Mode support */
@media (-ms-high-contrast: active) {
  :focus-visible {
    outline: 3px solid ButtonText !important;
    background-color: Highlight !important;
    color: HighlightText !important;
  }
}

/* Forced colors mode (Windows) */
@media (forced-colors: active) {
  :focus-visible {
    outline: 3px solid Highlight !important;
    outline-offset: 2px !important;
    background-color: Highlight !important;
    color: HighlightText !important;
    forced-color-adjust: none !important;
  }
}

/* Enhanced focus for custom components */

/* Dropdown menus */
.dropdown-trigger:focus-visible,
[aria-haspopup]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.25),
    0 2px 8px rgba(0, 102, 204, 0.3) !important;
}

/* Modal and dialog triggers */
[data-modal-target]:focus-visible,
[aria-controls^="modal"]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.3),
    0 3px 10px rgba(0, 102, 204, 0.4) !important;
  transform: scale(1.02) !important;
}

/* Carousel controls */
.carousel-button:focus-visible,
.swiper-button-next:focus-visible,
.swiper-button-prev:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.4),
    0 2px 8px rgba(0, 102, 204, 0.3) !important;
  background-color: rgba(0, 102, 204, 0.1) !important;
}

/* Tab navigation */
[role="tab"]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 3px rgba(0, 102, 204, 0.3),
    inset 0 -3px 0 #0066cc !important;
  background-color: rgba(0, 102, 204, 0.05) !important;
}

/* Accordion headers */
[aria-expanded]:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 5px rgba(0, 102, 204, 0.2),
    inset 0 0 0 1px rgba(0, 102, 204, 0.3) !important;
  background-color: rgba(0, 102, 204, 0.06) !important;
}

/* Search inputs - special treatment */
input[type="search"]:focus-visible,
.search-input:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 1px !important;
  border: 2px solid #0066cc !important;
  box-shadow: 
    inset 0 2px 4px rgba(0, 102, 204, 0.1),
    0 0 0 3px rgba(0, 102, 204, 0.25),
    0 2px 8px rgba(0, 102, 204, 0.2) !important;
  background-color: rgba(0, 102, 204, 0.03) !important;
}

/* Mobile-specific enhancements */
@media (max-width: 768px) {
  :focus-visible {
    outline-width: 4px !important;
    outline-offset: 3px !important;
    box-shadow: 0 0 0 6px rgba(0, 102, 204, 0.3) !important;
  }
  
  button:focus-visible,
  .btn:focus-visible {
    outline-width: 4px !important;
    box-shadow: 
      0 0 0 6px rgba(0, 102, 204, 0.3),
      0 4px 12px rgba(0, 102, 204, 0.4) !important;
  }
  
  /* Touch targets get larger focus indicators */
  .touch-target:focus-visible,
  [data-touch-target]:focus-visible {
    outline-width: 5px !important;
    outline-offset: 4px !important;
    box-shadow: 0 0 0 8px rgba(0, 102, 204, 0.4) !important;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  :focus-visible {
    transition: none !important;
    transform: none !important;
  }
  
  button:focus-visible,
  .btn:focus-visible,
  .card:focus-visible {
    transform: none !important;
  }
}

/* Print media - simplified focus for print */
@media print {
  :focus-visible {
    outline: 2px solid #000000 !important;
    outline-offset: 1px !important;
    box-shadow: none !important;
    background-color: transparent !important;
  }
}

/* Focus debugging and testing */
body[data-focus-debug="true"] :focus-visible {
  outline: 4px dashed #ff6b00 !important;
  outline-offset: 4px !important;
  box-shadow: 
    0 0 0 8px rgba(255, 107, 0, 0.3),
    inset 0 0 0 2px rgba(255, 107, 0, 0.5) !important;
}

body[data-focus-debug="true"] :focus-visible::before {
  content: "FOCUS" !important;
  position: absolute !important;
  top: -25px !important;
  left: 0 !important;
  background: #ff6b00 !important;
  color: white !important;
  padding: 2px 6px !important;
  font-size: 10px !important;
  font-weight: bold !important;
  z-index: 10000 !important;
}

/* Enhanced focus visibility for complex interactions */

/* Multi-step form progress */
.form-step:focus-visible,
.progress-step:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 3px !important;
  box-shadow: 
    0 0 0 6px rgba(0, 102, 204, 0.2),
    0 0 0 1px rgba(0, 102, 204, 0.4) !important;
}

/* Interactive images and media */
img[tabindex]:focus-visible,
video:focus-visible,
audio:focus-visible {
  outline: 4px solid #0066cc !important;
  outline-offset: 3px !important;
  box-shadow: 0 0 0 7px rgba(0, 102, 204, 0.3) !important;
}

/* Custom focus styles for specific UI patterns */

/* Breadcrumb navigation */
.breadcrumb a:focus-visible {
  outline: 2px solid #0066cc !important;
  outline-offset: 2px !important;
  background-color: rgba(0, 102, 204, 0.1) !important;
  border-radius: 3px !important;
}

/* Pagination controls */
.pagination a:focus-visible,
.page-link:focus-visible {
  outline: 3px solid #0066cc !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 4px rgba(0, 102, 204, 0.25),
    0 2px 6px rgba(0, 102, 204, 0.2) !important;
  transform: scale(1.1) !important;
}
