/* 
 * WCAG 2.2 - 2.4.11 Focus Not Obscured (AA)
 * Implementation for ensuring focused elements are never obscured by other content
 * 
 * Test: Keyboard navigate through all interactive elements
 * Expected: Focus indicators always visible, no focus obscured by overlays/sticky elements
 */

/* ============================================================================
   WCAG 2.4.11 Focus Not Obscured - Core Implementation 
   ============================================================================ */

/* Enhanced focus indicators for all interactive elements */
*:focus,
*:focus-visible {
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
  z-index: 9999 !important;
  position: relative !important;
}

/* High contrast focus for better visibility */
@media (prefers-contrast: high) {
  *:focus,
  *:focus-visible {
    outline: 4px solid #000000 !important;
    outline-offset: 2px !important;
    box-shadow: 0 0 0 2px #ffffff, 0 0 0 6px #000000 !important;
  }
}

/* Remove conflicting focus styles that could hide focus indicators */
*:focus {
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
}

/* Ensure buttons maintain proper focus styling */
button:focus,
.btn:focus,
input[type="button"]:focus,
input[type="submit"]:focus,
input[type="reset"]:focus {
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
  z-index: 9999 !important;
}

/* Form elements focus enhancement */
input:focus,
textarea:focus,
select:focus {
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
  border-color: #005a9d !important;
  z-index: 9999 !important;
}

/* Links focus enhancement */
a:focus {
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
  z-index: 9999 !important;
  text-decoration: underline !important;
}

/* Navigation focus management */
nav a:focus,
.nav-link:focus {
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
  z-index: 9999 !important;
  background-color: rgba(0, 90, 157, 0.1) !important;
}

/* Modal and overlay focus management */
.modal:focus-within,
.overlay:focus-within {
  z-index: 10000 !important;
}

/* Skip link always visible when focused */
.skip-link:focus {
  position: absolute !important;
  left: 6px !important;
  top: 7px !important;
  z-index: 999999 !important;
  background: #005a9d !important;
  color: white !important;
  padding: 8px 16px !important;
  text-decoration: none !important;
  border-radius: 4px !important;
  outline: 3px solid #ffffff !important;
  outline-offset: 2px !important;
}

/* Ensure carousel/slider controls are never obscured */
.swiper-button-next:focus,
.swiper-button-prev:focus,
.carousel-control:focus {
  z-index: 9999 !important;
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
}

/* FAQ accordion focus management */
.faq-toggle:focus,
details[open] summary:focus {
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
  z-index: 9999 !important;
}

/* Dropdown menu focus management */
.dropdown:focus-within,
.menu:focus-within {
  z-index: 9999 !important;
}

.dropdown-item:focus,
.menu-item:focus {
  background-color: rgba(0, 90, 157, 0.1) !important;
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
  z-index: 10000 !important;
}

/* Mobile menu focus management */
@media (max-width: 768px) {
  .mobile-menu:focus-within {
    z-index: 9999 !important;
  }
  
  .mobile-menu a:focus {
    background-color: rgba(0, 90, 157, 0.1) !important;
    outline: 3px solid #005a9d !important;
    outline-offset: 2px !important;
  }
}

/* Ensure focus is visible in dark mode */
@media (prefers-color-scheme: dark) {
  *:focus,
  *:focus-visible {
    outline: 3px solid #87ceeb !important;
    box-shadow: 0 0 0 1px #000000, 0 0 0 4px #87ceeb !important;
  }
}

/* Animation for smooth focus transitions */
*:focus,
*:focus-visible {
  transition: outline 0.1s ease-in-out, box-shadow 0.1s ease-in-out !important;
}

/* Prevent focus from being hidden by transforms */
.transform:focus,
.scale-95:focus,
.translate-x-full:focus {
  transform: none !important;
  z-index: 9999 !important;
}

/* Ensure absolutely positioned elements don't obscure focus */
.absolute:focus,
.fixed:focus {
  z-index: 9999 !important;
}

/* Custom focus styles for specific components */
.contact-form *:focus {
  box-shadow: 0 0 0 1px #ffffff, 0 0 0 4px #005a9d !important;
  outline: 3px solid #005a9d !important;
  outline-offset: 2px !important;
}

/* ============================================================================
   WCAG 2.4.11 Test Mode Styles
   ============================================================================ */

/* Test mode - highlights focus path and potential issues */
.wcag-focus-test *:focus {
  background-color: rgba(255, 255, 0, 0.3) !important;
  border: 2px dashed #ff0000 !important;
}

.wcag-focus-test *:focus::before {
  content: "FOCUS TEST" !important;
  position: absolute !important;
  top: -30px !important;
  left: 0 !important;
  background: #ff0000 !important;
  color: white !important;
  padding: 4px 8px !important;
  font-size: 10px !important;
  z-index: 999999 !important;
  font-family: monospace !important;
}

/* Print styles - ensure focus indicators work in print */
@media print {
  *:focus {
    outline: 2px solid #000000 !important;
    box-shadow: none !important;
  }
}