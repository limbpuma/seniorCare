---
import Button from "./Button.astro";

interface Props {
  subtitle?: string;
  title?: string;
  secondTitle?: string;
  thirdTitle?: string;
  description?: string;
  descriptionBold?: string;
  testimonial?: string;
  alignment?: 'left' | 'center' | 'right';
  textColor?: string;
  buttonText?: string;
  buttonVariant?: "primary" | "secondary" | "accent";
  buttonSize?: "small" | "medium" | "large";
  buttonHref?: string;
  // New props for proper heading hierarchy
  headingLevel?: 1 | 2 | 3 | 4 | 5 | 6;
  useSemanticHeadings?: boolean;
}

const {
  subtitle,
  title,
  secondTitle,
  thirdTitle,
  description,
  descriptionBold,
  testimonial,
  alignment = 'left',
  textColor = 'text-deep-blue',
  buttonText,
  buttonVariant = "primary",
  buttonSize = "medium",
  buttonHref,
  headingLevel = 2,
  useSemanticHeadings = true
} = Astro.props;

const alignmentClasses = {
  left: 'text-left',
  center: 'text-center',
  right: 'text-right'
};

const alignmentClass = alignmentClasses[alignment];

// Generate appropriate heading tags based on semantic hierarchy
const getHeadingTag = (level: number) => {
  const validLevel = Math.min(Math.max(level, 1), 6);
  return `h${validLevel}`;
};

const subtitleTag = useSemanticHeadings ? getHeadingTag(headingLevel) : 'p';
const titleTag = useSemanticHeadings ? getHeadingTag(headingLevel + (subtitle ? 1 : 0)) : 'h2';
const secondTitleTag = useSemanticHeadings ? getHeadingTag(headingLevel + (subtitle ? 2 : 1)) : 'h3';
const thirdTitleTag = useSemanticHeadings ? getHeadingTag(headingLevel + (subtitle ? 3 : 2)) : 'h4';
---

<div class={`${alignmentClass} ${textColor} max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 `}>
  {subtitle && (
    <Fragment set:html={`<${subtitleTag} class="text-ag-sub-heading font-ag-sub-heading mb-2 sm:mb-3 md:mb-4${useSemanticHeadings ? ' text-gray-600' : ''}">${subtitle}</${subtitleTag}>`} />
  )}
  {title && (
    <Fragment set:html={`<${titleTag} class="text-ag-h4 sm:text-ag-h3 md:text-ag-h2 lg:text-[56px] xl:text-[60px] font-ag-h2 mb-4 sm:mb-6 md:mb-8 leading-tight">${title}</${titleTag}>`} />
  )}
  {secondTitle && (
    <Fragment set:html={`<${secondTitleTag} class="text-ag-h5 sm:text-ag-h4 md:text-ag-h3 lg:text-[40px] xl:text-[44px] font-ag-h3 mb-3 sm:mb-4 md:mb-6 leading-tight">${secondTitle}</${secondTitleTag}>`} />
  )}
  {thirdTitle && (
    <Fragment set:html={`<${thirdTitleTag} class="text-ag-body-text sm:text-ag-h5 md:text-ag-h4 lg:text-[32px] xl:text-[34px] font-ag-h4 mb-2 sm:mb-3 md:mb-4 leading-tight">${thirdTitle}</${thirdTitleTag}>`} />
  )}
  {description && (
    <p class="text-ag-body-text font-ag-body-text mb-6 sm:mb-8 md:mb-10 max-w-3xl mx-auto">
      {description}
    </p>
  )}
  {descriptionBold && (
    <p class="font-bold text-ag-body-text font-ag-body-text mb-6 sm:mb-8 md:mb-10 max-w-3xl mx-auto">
      {descriptionBold}
    </p>
  )}
  {testimonial && (
    <blockquote class="text-ag-testimonial-text font-ag-testimonial-text italic mb-6 sm:mb-8 md:mb-10 max-w-2xl mx-auto">
      <p>"{testimonial}"</p>
    </blockquote>
  )}
  {buttonText && (
    <div class={`mt-6 sm:mt-8 md:mt-10 sm:mx-auto ${alignment === 'center' ? 'text-center' : ''}`}>
      <Button
        href={buttonHref}
        variant={buttonVariant}
        size={buttonSize}
      >
        {buttonText}
      </Button>
    </div>
  )}
</div>